
const allImages=Array.from(document.getElementsByClassName("slider__unselected"));const selectedImage=document.querySelector(".slider__display");let isSliding=0;const changeImage=(imageList,imageDisplay,imageIcon)=>{if(isSliding<=2){imageList.forEach(e=>e.classList.remove('slider__selected'));imageIcon.classList.add("slider__selected");imageDisplay.src=imageIcon.src;}}
allImages.forEach(e=>e.addEventListener('click',evt=>{changeImage(allImages,selectedImage,e);}));const zoomImage=document.querySelector(".slider__zoom");const zoomElement=document.querySelector(".purchase__zoom");const toggleOverlay=(overlayContainer)=>{overlayContainer.classList.toggle("purchase__overlay");document.body.classList.toggle("purchase__lock");}
selectedImage.addEventListener('click',evt=>{toggleOverlay(zoomElement);zoomImage.src=selectedImage.src;});zoomElement.addEventListener('click',evt=>{toggleOverlay(zoomElement);});const buyButton=document.getElementById("options_send");const buyElement=document.querySelector(".purchase__buy");const buyOverlayHide=document.querySelector(".buy__cancel");buyButton.addEventListener('click',evt=>{toggleOverlay(buyElement);});buyOverlayHide.addEventListener('click',evt=>{toggleOverlay(buyElement);});const imagesElement=document.querySelector(".slider__list");const imageSlider=document.querySelector(".slider");let isDown=false;let offsetX=0;let currentPosition=0;let initialPosition=allImages[0].getBoundingClientRect().left;const slideStart=(evt)=>{isDown=true;offsetX=evt.clientX-currentPosition;}
const slideEnd=()=>{isDown=false;let imageWidth=allImages[0].offsetWidth;let currFirstPos=allImages[0].getBoundingClientRect().left;let snapPosition=(currFirstPos>initialPosition)?0:Math.floor((currFirstPos-initialPosition)/imageWidth);if(allImages.length<5){currentPosition=0;}
else if(-snapPosition>allImages.length-5){currentPosition=-(allImages.length-5)*imageWidth;}
else{currentPosition=snapPosition*imageWidth;}
imageSlider.style.transform="translateX("+currentPosition+"px)";setTimeout(()=>{isSliding=0;},100);}
const slideMove=evt=>{if(isDown){isSliding++;imageSlider.style.transform="translateX("+(evt.clientX-offsetX)+"px)";currentPosition=evt.clientX-offsetX;}}
imagesElement.addEventListener('mousedown',evt=>{slideStart(evt);});document.body.addEventListener('mouseup',evt=>{if(isDown&&isSliding)slideEnd();else isDown=false;});document.body.addEventListener('mousemove',evt=>{slideMove(evt);});imagesElement.addEventListener('touchstart',evt=>{let style=imageSlider.getAttribute('style');imageSlider.setAttribute('style',style+"transition: transform 0s ease-in-out;");slideStart(evt.touches[0]);});document.body.addEventListener('touchend',evt=>{if(isDown&&isSliding){let style=imageSlider.getAttribute('style');imageSlider.setAttribute('style',style+"transition: transform 0.2s ease-in-out;");slideEnd();}
else isDown=false;});document.body.addEventListener('touchmove',evt=>{slideMove(evt.touches[0]);});function on_resize(cb,t){onresize=function(){clearTimeout(t);t=setTimeout(cb,100);};return cb;};on_resize(function(){initialPosition=imagesElement.getBoundingClientRect().left+3;slideEnd();})();